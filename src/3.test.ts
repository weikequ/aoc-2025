import { expect, test } from "bun:test";
import {
  findLargestSequentialN,
  findLargestSequentialPair,
  flspBrute,
  parse,
} from "./3";
import { getInput } from "./utils";

const sample = `3523353336456373315333436233333335232333732343335433562322563333522235325212523333363314232443263643
2314342234111113133311211432343132211444241411312124123312331141344443331243134443442112314242456789
4353274144444287398983647445438678793767694364466552469357365921634986377848424726873285333545845731
2432365333234322323432364633422244334327432633342462454532254233232331324343333216367223235335322123
2323334335323325443335223323433322423333254243333123232324323432323133226413233313332332313432323273
4233233446424366833333332443333337334455644244342234344442343333433433239345424213332324332374333362
3333333323333335242333333335635233233333233333223333343335333353433133213252231534338341263533317333
5384467582246472644667557756736226252375978356526218277574624473866633725366642445262666647363721663
2322375425534432355134237553315353243324333333392433343231343255223343333524543763353733333335326335
2522212221222142522212235252323125121222222724224212332321325222222222225222221122224234522212112212
2323232222242212223233122222212322225242332423242222222211222223222222222222222232112212232222222253
2525228222225166324572224321154343235122325222142424523432412315655422222342554552325614222325212322
2221222112621332222222322422222122221212131244122211112222222312322322232222212223212221223222212232
6466665669645464226256457666556465672536455544356665362555637454646552643755455566546541658654554536
6444746647444543553443364436564474472443673446443347384344345645444745374734274447548472344573735855`;

test("parsing", () => {
  const expected = [
    "3523353336456373315333436233333335232333732343335433562322563333522235325212523333363314232443263643",
    "2314342234111113133311211432343132211444241411312124123312331141344443331243134443442112314242456789",
    "4353274144444287398983647445438678793767694364466552469357365921634986377848424726873285333545845731",
    "2432365333234322323432364633422244334327432633342462454532254233232331324343333216367223235335322123",
    "2323334335323325443335223323433322423333254243333123232324323432323133226413233313332332313432323273",
    "4233233446424366833333332443333337334455644244342234344442343333433433239345424213332324332374333362",
    "3333333323333335242333333335635233233333233333223333343335333353433133213252231534338341263533317333",
    "5384467582246472644667557756736226252375978356526218277574624473866633725366642445262666647363721663",
    "2322375425534432355134237553315353243324333333392433343231343255223343333524543763353733333335326335",
    "2522212221222142522212235252323125121222222724224212332321325222222222225222221122224234522212112212",
    "2323232222242212223233122222212322225242332423242222222211222223222222222222222232112212232222222253",
    "2525228222225166324572224321154343235122325222142424523432412315655422222342554552325614222325212322",
    "2221222112621332222222322422222122221212131244122211112222222312322322232222212223212221223222212232",
    "6466665669645464226256457666556465672536455544356665362555637454646552643755455566546541658654554536",
    "6444746647444543553443364436564474472443673446443347384344345645444745374734274447548472344573735855",
  ];
  expect(parse(sample)).toStrictEqual(expected);
});

test("findLargestSequentialPair", () => {
  const tests = [
    {
      input: "987654321111111",
      expected: 98,
    },
    {
      input: "811111111111119",
      expected: 89,
    },
    {
      input: "234234234234278",
      expected: 78,
    },
    {
      input: "818181911112111",
      expected: 92,
    },
    // {
    //   input:
    //     "3342533722236333322633425352248943333664335354553353432463345313443143243616753253533345354575333571",
    //   expected: 97,
    // },
  ];

  tests.map((test) => {
    expect(findLargestSequentialPair(test.input)).toEqual(test.expected);
  });
});

test("compare algos", async () => {
  // const input =
  //   "3724452222423143621224733234132233331563322432333223233435314133632231361535262323222332132634532413";
  // console.log("flsp:", findLargestSequentialPair(input));
  // console.log("flspBrute:", flspBrute(input));
  const input = await getInput(3);
  const banks = parse(input);

  banks.map((bank) => {
    try {
      expect(flspBrute(bank)).toEqual(findLargestSequentialPair(bank));
    } catch (e) {
      console.log(bank);
      console.log(e);
    }
  });
});

test("findLargestSequentialN", () => {
  const tests = [
    {
      input: "987654321111111",
      n: 2,
      expected: 98,
    },
    {
      input: "811111111111119",
      n: 2,
      expected: 89,
    },
    {
      input: "234234234234278",
      n: 2,
      expected: 78,
    },
    {
      input: "818181911112111",
      n: 2,
      expected: 92,
    },
    {
      input: "987654321111111",
      n: 12,
      expected: 987654321111,
    },
    {
      input: "811111111111119",
      n: 12,
      expected: 811111111119,
    },
    {
      input: "234234234234278",
      n: 12,
      expected: 434234234278,
    },
    {
      input: "818181911112111",
      n: 12,
      expected: 888911112111,
    },
    {
      input:
        "3342533722236333322633425352248943333664335354553353432463345313443143243616753253533345354575333571",
      n: 2,
      expected: 97,
    },
  ];

  tests.map((test) => {
    expect(findLargestSequentialN(test.input, test.n)).toEqual(test.expected);
  });
});
